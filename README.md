# OpenCV
##  허프 변환 Line-Detection (달리기 레일 위에서 시각장애인을 위한 걷기 보조 프로그램)
### ▶프로잭트에 대한 개요
=> 시각장애인이 보호자, 안내견, 흰 지팡이의 도움 없이 혼자서 걷기 운동을 할 수 있으면 좋을거 같다는 생각을 시작으로 자율주행 차량이 차선을 탐지하는 것을 응용하여 시각장애인에게 현재 레일에서 향해야 하는 방향을 알려주어 홀로 걷기 운동을 할 수 있게 도와주는 프로그램.
### ▶핵심 코드 설명
☞원하는 영역 mask


![image](https://user-images.githubusercontent.com/86768006/128275507-043c5fae-97bb-414b-a42b-c0605f223d65.png)


=> 영상에서 달리기 레일이 있을 만한 영역(사람의 시야에서 라인이 있을 범위)을 mask 처리를 사용하여 그 이외의 영역은 날려주는 과정. 보통 사람의 눈으로 봤을 때 레일이 멀수록 양쪽이 좁아지게 중앙으로 모이고 레일이 가까울수록 양쪽으로 넓게 퍼져간다. 그에 맞는 다각형 도형을 mask에 그려준다.

☞중간 처리 과정


![image](https://user-images.githubusercontent.com/86768006/128275587-811a6c4b-7f1e-44e8-85f4-8dfb4b7699b8.png)


=> 영상을 불러와 한 프레임을 읽고 그 프레임 이미지를 처리하는 과정이다.
첫째, 컬러 이미지를 그레이스케일로 바꿔준다.
둘째, 블러 처리를 통하여 노이즈를 처리해준다. //잡음을 제거
셋째, 케니 에지 검출로 에지를 검출한다.
넷째, 위에서 만든 mask를 사용하여 mask 내의 에지만 검출한다.
다섯째, 검출한 에지를 확률 허프 변환을 통해 직선들의 시작점과 끝점을 구한다.

☞직선 그리기, 방향 알려주기


![image](https://user-images.githubusercontent.com/86768006/128275630-eb135940-a999-44ba-a5a0-2f9073ece1bd.png)



=> 직선들의 시작점(x1, y1)과 끝점(x2. y2)를 사용하여 직선을 그리고 향해야 할 방향을 알려준다. 이때 직선들의 기울기를 사용하여 연산하는데 주의해야 할 사항이 있다. 첫째, 기울기는 y 증가량 / x 증가량이므로 x 증가량이 0이 되는 경우를 예외처리해 준다. 둘째, 이미지상의 x 증가량 y 증가량이므로 x 증가량이 x2-x1일 때 y 증가량은 y1-y2가 된다. 직선이 그려지는 개수를 체크하는데 보통 최대 5~6개 정도 그려짐으로 직선 5개가 그려졌을 때 기울기의 총합(평균을 대신)을 구하여 –2보다 작으면 “left”를 출력하여 왼쪽을, 2보다 크면 “right”를 출력하여 오른쪽을, -2보다 크고 2보다 작으면 “straight”를 출력하여 정면을 향하게 알려준다.
